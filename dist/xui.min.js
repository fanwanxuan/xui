!function(e){"use strict";e.support=function(){return{touch:!!("ontouchstart"in window)}}(),e.events={start:e.support.touch?"touchstart":"mousedown",move:e.support.touch?"touchmove":"mousemove",end:e.support.touch?"touchend":"mouseup",click:e.support.touch?"touchend":"click"};var t=function(t){function a(t,a){var n=e(t);l.opened=!1,n.addClass("modal-out").removeClass("modal-in");var o=setTimeout(function(){clearTimeout(o),n.remove()},400);!function(){var e={format:u.format,value:l.displayValue},n={input:c.input,value:l.displayValue};u.formatValue&&(n.string=u.formatValue(e)),a&&a.call(t,c.input,n)}()}function n(e,t){var a="all "+(t||0)+"ms linear";e.css({"-webkit-transition":a,transition:a})}function o(e,t,a){var o="translate3d(0,"+(t||0)+"px,0)";e.css({"-webkit-transform":o,transform:o}),n(e,a)}function i(e,t){var a,n,o,i;return"undefined"==typeof t&&(t="x"),o=window.getComputedStyle(e,null),window.WebKitCSSMatrix?(i=new WebKitCSSMatrix("none"===o.webkitTransform?"":o.webkitTransform),n="x"===t?i.m41:i.m42):(i=o.MozTransform||o.transform||o.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),a=i.toString().split(","),"x"===t&&(n=16===a.length?parseFloat(a[12]):parseFloat(a[4])),"y"===t&&(n=16===a.length?parseFloat(a[13]):parseFloat(a[5]))),n||0}function r(t){if(t.target!=c.input[0]&&!e(t.target).closest(".picker-modal")[0]){var a=e(".picker-modal.modal-in");a.trigger("close")}}var l=this,s={cols:[],atOnce:!0,suffix:!0,onOpen:null,onClose:null,onConfirm:null,inputReadOnly:!0,toolbarTitle:"请选择",toolbarCloseText:"确定"},u=e.extend({},s,t);u.toolbarTpl=['<header class="tool-bar">','<h1 class="title">'+u.toolbarTitle+"</h1>",'<button class="close-picker">'+u.toolbarCloseText+"</button>","</header>"].join(""),l.initialized=!1,l.opened=!1,l.inline=!1,l.displayValue=u.value.concat()||[];var c={body:e(document.body),input:e(u.input)};l.inline=!!c.modal,l.layout=function(){var t=u.value.length,a=['<div class="picker-modal modal-out" style="display:block">',u.toolbarTpl,'<div class="picker-items"><div class="picker-center-highlight"></div>'];return u.cols.length&&(e.each(u.cols,function(n,o){return t&&n>t-1?!1:(a.push('<div class="picker-items-col"><div class="picker-items-col-wrapper">'),e.each(o.values,function(e,t){var n=u.suffix&&o.suffix?t+o.suffix:t;a.push('<div class="picker-item">'+n+"</div>")}),void a.push("</div></div>"))}),a.push("</div></div>")),e(a.join("")).appendTo(c.body)},l.open=function(){l.opened||(l.initialized=!0,l.inline||(c.modal=e(l.layout()),c.cols=c.modal.find(".picker-items-col"),c.modal.on("close",function(){a(this,function(e,t){!u.atOnce&&u.onClose&&u.onClose.call(e,t)})}),c.modal.on("confirm",function(){!u.atOnce&&u.onConfirm?a(this,function(e,t){u.onConfirm.call(e,t)}):c.modal.trigger("close")})),e.each(c.cols,function(){l.initCols(this)}),c.modal.show().addClass("modal-in").removeClass("modal-out")),l.opened=!0,u.onOpen&&u.onOpen()},l.close=function(){l.opened&&c.modal.trigger("close")},l.setValue=function(){u.onChange&&u.onChange(u),u.atOnce&&l.showResult()},l.showResult=function(){var e={value:l.displayValue},t=u.formatValue?u.formatValue(e):e.value.join(" "),a="input"===c.input[0].tagName.toLowerCase()?"val":"text";c.input[a](t)},l.initCols=function(t){function a(e){return m||v?!1:(e.preventDefault(),v=!0,h="touchstart"===e.type?e.targetTouches?e.targetTouches[0].pageY:e.originalEvent.targetTouches[0].pageY:e.pageY,void(w=k=i(f.wrapper[0],"y")))}function n(e){return v?(e.preventDefault(),v=!0,g="touchmove"===e.type?e.targetTouches?e.targetTouches[0].pageY:e.originalEvent.targetTouches[0].pageY:e.pageY,y=g-h,k=w+y,k>D&&(k=D+T/2),b>k&&(k=b-T/2),o(f.wrapper,k,200),void f.highlightItem(null,k)):!1}function r(e){v=m=!1,k=Math.round(k/T)*T,k>D&&(k=D),b>k&&(k=b),o(f.wrapper,k,200),l.setValue()}var s=l.displayValue.length&&l.displayValue||u.value,p=e(t),d=c.cols.index(p),f=u.cols[d];f.value=s[d]||f.values[0],f.container=p,f.wrapper=f.container.find(".picker-items-col-wrapper"),f.items=f.container.find(".picker-item");var v,m,h,g,y,w,k,x,C,T,b,D;x=f.container[0].offsetHeight,T=f.items[0].offsetHeight,C=T*f.items.length,b=x/2+T/2-C,D=x/2-T/2,f.setColTranslate=function(t){var a=f.activeIndex=e.inArray(t,f.values),n=-a*T+D;o(f.wrapper,n,200),f.highlightItem(a,n)},f.highlightItem=function(e,t){t||(t=i(f.wrapper[0],"y")),e||(e=-Math.round((t-D)/T)),0>e&&(e=0),e>=f.items.length&&(e=f.items.length-1),l.displayValue[d]=f.value=f.values[e],f.activeIndex!=e&&(f.activeIndex=e),f.items.eq(e).addClass("picker-selected").siblings().removeClass("picker-selected")},f.handleEvents=function(t){f.container[t](e.events.start,a),f.container[t](e.events.move,n),f.container[t](e.events.end,r)},f.setColTranslate(f.value),f.handleEvents("on")},u.inputReadOnly&&c.input.attr("readonly",!0),l.inline||(e(window).off().on(e.events.click,r),c.input.off().on(e.events.click,function(t){if(t.stopPropagation(),e(this).hasClass("disabled"))return!1;if(!l.opened){var a=e(".picker-modal.modal-in");a.trigger("close"),l.open()}}))};e(document).off().on(e.events.click,".close-picker",function(){var t=e(".picker-modal.modal-in");t.trigger("confirm")}),e.fn.picker=function(a){var n=arguments;return this.each(function(){if(this){var o=e(this),i=o.data("picker");if(!i){var r="input"===o[0].tagName.toLowerCase()?"val":"text",l=e.extend({input:o,value:o[r]().split(" ")},a||{});i=new t(l),o.data("picker",i)}"string"==typeof a&&i[a].apply(i,Array.prototype.slice.call(n,1))}})}}(window.jQuery||window.Zepto),function(e){"use strict";var t={today:new Date,zeroFixed:function(e){return parseInt(e)<10?"0"+parseInt(e):""+e},makeArr:function(e,a){for(var n=[],o=a||0;e>=o;o++)n.push(t.zeroFixed(o));return n},getDaysByYearAndMonth:function(e,t){return new Date(new Date(e,t,1)-1).getDate()},formatDate:function(e,a){for(var n=0;n<e.length;n++)e[n]=t.zeroFixed(e[n]);var o={"y+":e[0]||t.today.getFullYear(),"M+":e[1]||t.today.getMonth()+1,"d+":e[2]||t.today.getDate(),"h+":e[3]||t.today.getHours(),"m+":e[4]||t.today.getMinutes(),"s+":e[5]||t.today.getSeconds()};for(var i in o)new RegExp("("+i+")").test(a)&&(a="y+"===i?a.replace(RegExp.$1,(o[i]+"").substr(4-RegExp.$1.length)):a.replace(RegExp.$1,1==RegExp.$1.length?o[i]:("00"+o[i]).substr((""+o[i]).length)));return a},DateStringToArr:function(a){var n=a?new Date(a):new Date;return e.map([n.getFullYear(),n.getMonth()+1,n.getDate(),n.getHours(),n.getMinutes()],function(e,a){return t.zeroFixed(e)})}},a={format:"yyyy-MM-dd hh:mm",value:[],yearLimit:[1950,2030],level:5,onChange:function(e){var a=t.getDaysByYearAndMonth(e.cols[0].value,e.cols[1].value),n=e.cols[2].value;n>a&&(n=a.toString()),e.cols[2].value=n,e.cols[2].setColTranslate(n)},formatValue:function(e){return t.formatDate(e.value,e.format||a.format)}};a.value=t.DateStringToArr(),a.cols=[{values:t.makeArr(a.yearLimit[1],a.yearLimit[0]),suffix:"年"},{values:t.makeArr(12,1),suffix:"月"},{values:t.makeArr(31,1),suffix:"日"},{values:t.makeArr(23),suffix:"时"},{values:t.makeArr(59),suffix:"分"},{values:t.makeArr(59),suffix:"秒"}],e.fn.datetimePicker=function(n){return this.each(function(){if(this){var o=e(this),i=e.extend({},a,n||{}),r="input"===o[0].tagName.toLowerCase()?"val":"text";if(n&&n.value)o[r](t.formatDate(n.value,i.format));else{var l=o.data("val")||o[r]();l=e.trim(l),l&&(i.value=t.DateStringToArr(l))}i.value=Array.prototype.slice.call(i.value,0,i.level),o.picker(i)}})}}(window.jQuery||window.Zepto);